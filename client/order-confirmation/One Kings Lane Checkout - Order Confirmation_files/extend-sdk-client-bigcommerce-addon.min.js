/*!
 * Copyright (c) 2019-present, Extend, Inc.
 * version: 1.0.20
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ExtendBigCommerce=t():e.ExtendBigCommerce=t()}(this,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=13)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dispatchErrorEvent=function(e){var t=e.type,n=e.error,r=e.sdkName,o=document.createEvent("CustomEvent");o.initCustomEvent("_extend:errorTrackEvent",!0,!0,{type:t,error:n,sdkName:r}),window.dispatchEvent(o)},t.ERROR_TRACK_EVENT=void 0;t.ERROR_TRACK_EVENT="_extend:errorTrackEvent"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapCallback=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(t&&console.error(t),"function"==typeof e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];e.apply(void 0,[t||null].concat(r))}}},t.wrapCallbackForCart=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0;t&&console.error(t),"function"==typeof e&&e(t,n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateCartQuantity=function(e,t){var n=window.location.origin;return(0,r.request)("".concat(n,"/remote/v1/cart/update"),{method:"POST",body:"items[0][id]=".concat(e,"&items[0][quantity]=").concat(t),contentType:"application/x-www-form-urlencoded; charset=UTF-8"}).then(o)},t.removeCartItem=function(e){return(0,r.request)("".concat("/api/storefront","/carts/").concat(e.cartId,"/items/").concat(e.itemId),{method:"DELETE"}).then(o)},t.addItemToCart=function(e){var t=e.productId,n=e.variantId,i=e.quantity,a=e.cartId,c=e.optionSelections,u=void 0===c?[]:c,d="".concat("/api/storefront","/carts/").concat(a,"/items?include=lineItems.digitalItems.options,lineItems.physicalItems.options");return(0,r.request)(d,{method:"POST",body:JSON.stringify({lineItems:[{productId:t,quantity:i,variantId:n,optionSelections:u}]}),withCredentials:!0}).then(o)},t.getCartData=function(){return(0,r.request)("".concat("/api/storefront","/carts?include=lineItems.digitalItems.options,lineItems.physicalItems.options")).then(o)},t.getGraphQLData=function(e,t){return(0,r.request)("/graphql",{method:"POST",authorization:"Bearer ".concat(t),body:JSON.stringify({query:e})}).then(o)};var r=n(10);function o(e){var t=e.data;if(void 0===t)throw new Error("Unable to retrieve cart data");return Array.isArray(t)?t[0]:t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSPPlan=o,t.getShippingPlan=function(e){return e.find((function(e){return o(e)}))},t.getSPPlanDetails=function(e){var t=e.sku.split(";xtd;")[0],n=Math.round(100*e.listPrice);return{quoteId:t,premium:n}},t.isSpPlanChangeRequired=i,t.getUpdatedSpQuote=function(e){return new Promise((function(t){window.Extend.shippingProtection.getUpdatedSPQuote({items:e,onUpdate:function(e){var n=e.quote,r=e.attachBehavior;return t({quote:n,attachBehavior:r})}})}))},t.getSPCartUpdates=function(e){var t=e.cart,n=e.quote,a=e.attachBehavior,c=t.lineItems.customItems.filter(o),u=window.Extend.shippingProtection.getSPUserConfig();if(0===c.length)return!n||0===n.premium||null!=u&&u.isUserOptOut||a===r.ShippingAttachBehavior.OPT_IN?{spUpdates:null,shouldAddSp:!1}:a===r.ShippingAttachBehavior.OPT_MERCHANT||a===r.ShippingAttachBehavior.OPT_OUT?{spUpdates:null,shouldAddSp:!0}:{spUpdates:null,shouldAddSp:!1};var d={};if(!n||0===n.premium)return c.forEach((function(e){d[e.id]="remove"})),{spUpdates:d,shouldAddSp:!1};var s=c.find((function(e){return!i(e,n)}))||c[0];c.length>1&&c.forEach((function(e){e!==s&&(d[e.id]="remove")}));i(s,n)&&(d[s.id]="replace");s.quantity>1&&!i(s,n)&&(d[s.id]="update");return 0===Object.entries(d).length?{spUpdates:null,shouldAddSp:!1}:{spUpdates:d,shouldAddSp:!1}},t.WARRANTY_SEPARATOR=void 0;var r=n(7);function o(e){return Boolean("Extend Shipping Protection Plan"===e.name&&2===e.sku.split(";xtd;").length&&["SP","SHIPPING_PROTECTION"].includes(e.sku.split(";xtd;")[1]))}function i(e,t){var n=e.sku.split(";xtd;")[0],r=Math.round(100*e.listPrice);return n!==t.id||r!==t.premium}t.WARRANTY_SEPARATOR=";xtd;"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatCartItemsForSp=function(e){if(!e)return console.warn('Missing required argument "cart" in shippingProtectionInCart(cart)'),(0,r.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-big-commerce/format-cart-items-for-sp - formatCartItemsForSp",missingParams:["cart"]},sdkName:"extend-sdk-client-bigcommerce-addon"}),[];var t=null==e?void 0:e.lineItems;if(!t)return[];return t.physicalItems.map((function(e){return{referenceId:e.sku.toString(),quantity:e.quantity,purchasePrice:Math.round(100*e.listPrice),productName:e.name}}))};var r=n(0)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addToCart=function(e,t){var n="https://".concat(o(t),"/cart/add");return(0,r.request)(n,{bigCommerceIntRequest:!0,method:"POST",body:JSON.stringify(e)}).then((function(e){var t=e.status,n=e.data;if(!(200===t||201===t&&n))throw new Error("Failure to add to cart");return{status:t,data:n}}))},t.addSpPlanToCart=function(e,t){var n="https://".concat(o(t),"/cart/shippingProtection/add");return(0,r.request)(n,{bigCommerceIntRequest:!0,method:"POST",body:JSON.stringify(e)}).then((function(e){var t=e.status,n=e.data;if(!(200===t||201===t&&n))throw new Error("Failure to add sp plan to cart");return{status:t,data:n}}))},t.updateSpPlanInCart=function(e,t){var n="https://".concat(o(t),"/cart/shippingProtection/update");return(0,r.request)(n,{bigCommerceIntRequest:!0,method:"POST",body:JSON.stringify(e)}).then((function(e){var t=e.status,n=e.data;if(!(200===t||201===t&&n))throw new Error("Failure to update sp plan in cart");return{status:t,data:n}}))};var r=n(10);function o(e){return"acceptance"===e?"integ-bc-acceptance.extend.com":"development"===e?"integ-bc-dev.extend.com":"stage"===e?"integ-bc-stage.extend.com":"demo"===e?"integ-bc-demo.extend.com":"partnerssandbox"===e?"integ-bc-partnerssandbox.extend.com":"platformsandbox"===e?"integ-bc-platformsandbox.extend.com":"enterprisesandbox"===e?"integ-bc-enterprisesandbox.extend.com":"integ-bc.extend.com"}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(20)),o=i(n(21));function i(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var c=setTimeout;function u(e){return Boolean(e&&void 0!==e.length)}function d(){}function s(e){if(!(this instanceof s))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],h(e,this)}function l(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,s._immediateFn((function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var r;try{r=n(e._value)}catch(e){return void p(t.promise,e)}f(t.promise,r)}else(1===e._state?f:p)(t.promise,e._value)}))):e._deferreds.push(t)}function f(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===a(t)||"function"==typeof t)){var n=t.then;if(t instanceof s)return e._state=3,e._value=t,void m(e);if("function"==typeof n)return void h((r=n,o=t,function(){r.apply(o,arguments)}),e)}e._state=1,e._value=t,m(e)}catch(t){p(e,t)}var r,o}function p(e,t){e._state=2,e._value=t,m(e)}function m(e){2===e._state&&0===e._deferreds.length&&s._immediateFn((function(){e._handled||s._unhandledRejectionFn(e._value)}));for(var t=0,n=e._deferreds.length;t<n;t++)l(e,e._deferreds[t]);e._deferreds=null}function v(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function h(e,t){var n=!1;try{e((function(e){n||(n=!0,f(t,e))}),(function(e){n||(n=!0,p(t,e))}))}catch(e){if(n)return;n=!0,p(t,e)}}s.prototype.catch=function(e){return this.then(null,e)},s.prototype.then=function(e,t){var n=new this.constructor(d);return l(this,new v(e,t,n)),n},s.prototype.finally=r.default,s.all=function(e){return new s((function(t,n){if(!u(e))return n(new TypeError("Promise.all accepts an array"));var r=Array.prototype.slice.call(e);if(0===r.length)return t([]);var o=r.length;function i(e,c){try{if(c&&("object"===a(c)||"function"==typeof c)){var u=c.then;if("function"==typeof u)return void u.call(c,(function(t){i(e,t)}),n)}r[e]=c,0==--o&&t(r)}catch(e){n(e)}}for(var c=0;c<r.length;c++)i(c,r[c])}))},s.allSettled=o.default,s.resolve=function(e){return e&&"object"===a(e)&&e.constructor===s?e:new s((function(t){t(e)}))},s.reject=function(e){return new s((function(t,n){n(e)}))},s.race=function(e){return new s((function(t,n){if(!u(e))return n(new TypeError("Promise.race accepts an array"));for(var r=0,o=e.length;r<o;r++)s.resolve(e[r]).then(t,n)}))},s._immediateFn="function"==typeof e&&function(t){e(t)}||function(e){c(e,0)},s._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var g=s;t.default=g}).call(this,n(17).setImmediate)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ShippingAttachBehavior=t.SP_PLAN_REMOVED_FROM_CART_BY_USER=t.SP_PLAN_ADDED_TO_CART=void 0;t.SP_PLAN_ADDED_TO_CART="SP Line Item added to Cart";var r;t.SP_PLAN_REMOVED_FROM_CART_BY_USER="SP Plan Item removed from Cart by user",t.ShippingAttachBehavior=r,function(e){e.OPT_IN="OPT_IN",e.OPT_OUT="OPT_OUT",e.OPT_MERCHANT="OPT_MERCHANT"}(r||(t.ShippingAttachBehavior=r={}))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addPlanToCart=function(e,t){var n,r=e.cart,f=e.sku,p=e.plan,m=e.quantity,v=void 0===m?1:m,h=e.priceBandRefId,g=e.leadToken,y=e.offerType,b=void 0===y?{area:"cart_page",component:"modal"}:y,I=e.price,P=e.category,_=(0,i.wrapCallback)(t);if(void 0===window.Extend)return void _(new Error('Missing required dependency "Extend"'));if(!p||!f){var C=[];return f||C.push("sku"),p||C.push("plan"),(0,a.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-big-commerce/add-plan-to-cart - addPlanToCart",missingParams:C},sdkName:"extend-sdk-client-bigcommerce-addon"}),void _(new Error("Missing argument: plan and/or sku"))}var E=window.Extend.config();if(!E.storeId)return(0,a.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-big-commerce/add-plan-to-cart - addPlanToCart",missingParams:["storeId"]},sdkName:"extend-sdk-client-bigcommerce-addon"}),void _(new Error('Could not find "storeId". Did you forget to call Extend.config()?'));r&&(n=o.default.resolve(r));(n||(0,u.getCartData)()).then((function(e){var t,n;if(e){if(t=e.id,g&&(0,d.isLeadAlreadyInCart)(g,e))return void _(null);n=function(e,t,n,r){var o,i="".concat(e.title," - ").concat(l(e.term)).toLowerCase(),a=t.lineItems.customItems.filter((function(e){return e.name.toLowerCase().includes(i)}));if(a.length){var c=a.map((function(e){var t=e.name.match(/\(([A-Z])+\)/);return t?t[0]:""}));o=s(a.length,c)}var u=t.lineItems.customItems.find((function(e){return e.sku.includes(";xtd;".concat(n))&&!r}));if(u&&a.length){var d=u.name.match(/\(([A-Z])+\)/);o=d?d[0]:void 0}return o}(p,e,f,g)}(0,c.addToCart)({cartId:t,storeId:E.storeId,referenceId:f,planId:p.planId,quantity:v,appendToTitle:n,priceBandRefId:h,leadToken:g,price:I,category:P,offerPlanId:p.offerPlanId},E.environment).then((function(e){null!=e&&e.data?_(null,e.data):_(null)})).catch(_),window.Extend.trackOfferAddedToCart({productId:f,planId:p.planId,warrantyQuantity:Number(v)||1,productQuantity:Number(v)||1,offerType:b})}))},t.numToAlpha=s,t.humanizeTermLength=l;var r,o=(r=n(6))&&r.__esModule?r:{default:r},i=n(1),a=n(0),c=n(5),u=n(2),d=n(11);function s(e,t){for(var n,r=e,o="";r>0;)n=(r-1)%26,o=String.fromCharCode(65+n)+o,r=Math.floor((r-n)/26),t.includes("(".concat(o,")"))&&(r=e+1,o="",n=void 0);return"(".concat(o,")")}function l(e){return 999===e?"Lifetime":1===e?"1 month":e%12!=0?"".concat(e," months"):12===e?"1 year":"".concat(e/12," years")}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o;o=function(){return this}();try{o=o||new Function("return this")()}catch(e){"object"===("undefined"==typeof window?"undefined":r(window))&&(o=window)}e.exports=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.request=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new o.default((function(n,r){var o=new XMLHttpRequest;o.addEventListener("load",(function(){var r=a(o.response);o.status>=400&&(0,i.dispatchErrorEvent)({type:t.bigCommerceIntRequest?"extend_api_error":"bigcommerce_api_error",error:{statusCode:o.status,requestUrl:e,requestParams:t,responseBody:r},sdkName:"extend-sdk-client-bigcommerce-addon"}),n({status:o.status,data:r})})),o.addEventListener("error",(function(n){var c=a(o.response);(0,i.dispatchErrorEvent)({type:t.bigCommerceIntRequest?"extend_api_error":"bigcommerce_api_error",error:{statusCode:o.status,requestUrl:e,requestParams:t,responseBody:c},sdkName:"extend-sdk-client-bigcommerce-addon"}),r(n)})),o.open(t.method||"GET",e,!0),o.setRequestHeader("Accept","application/json"),t.body&&o.setRequestHeader("Content-Type",t.contentType||"application/json"),t.authorization&&o.setRequestHeader("Authorization",t.authorization),o.withCredentials=t.withCredentials||!1,o.responseType="json",o.send(t.body)}))},t._parseResponse=void 0;var r,o=(r=n(6))&&r.__esModule?r:{default:r},i=n(0);function a(e){if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e}var c=a;t._parseResponse=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.warrantyAlreadyInCart=o,t.isLeadAlreadyInCart=function(e,t){return o("LEAD::".concat(e),t)};var r=n(0);function o(e,t){var n=[];return e||(console.warn('Missing required argument "sku" in warrantyAlreadyInCart(sku, cart)'),n.push("sku")),t||(console.warn('Missing required argument "cart" in warrantyAlreadyInCart(sku, cart)'),n.push("cart")),n.length?((0,r.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-big-commerce/warranty-in-cart - warrantyAlreadyInCart",missingParams:n},sdkName:"extend-sdk-client-bigcommerce-addon"}),!0):t.lineItems.customItems.filter((function(t){var n=";xtd;".concat(e);return t.sku.includes(n)})).length>0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCartUpdates=c,t.sortByPrice=u,t.getLeadMaxQuantityFromSku=l,t.getWarrantyReferenceIdFromSku=f,t.normalizeCart=void 0;var r,o=(r=n(6))&&r.__esModule?r:{default:r},i=n(2),a=n(3);function c(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n={},r={},o=e.lineItems.physicalItems.concat(e.lineItems.digitalItems);return o.forEach((function(e){n[e.sku]?n[e.sku].quantity+=e.quantity:n[e.sku]={quantity:e.quantity,warrantyQuantity:0,warranties:[]}})),e.lineItems.customItems.forEach((function(e){if(s(e)){var o=l(e.sku),i=e.quantity-o;(i>0||t&&0!==i)&&(r[e.id]=o)}else if(d(e)){var a=f(e.sku);if(!n[a])return void(r[e.id]=0);n[a].warrantyQuantity+=e.quantity,n[a].warranties.push(e)}})),Object.values(n).forEach((function(e){var n=e.warrantyQuantity-e.quantity;if(0!==n){var o=e.warranties.sort(u);if(n<0){if(t&&o.length){var i=o[o.length-1];r[i.id]=i.quantity-n}}else o.forEach((function(e){if(0!==n){var t=Math.max(0,n-e.quantity),o=n-t;r[e.id]=e.quantity-o,n=t}}))}})),Object.keys(r).length?r:null}function u(e,t){return e.listPrice-t.listPrice}function d(e){return e.sku.includes(";xtd;")&&!(0,a.isSPPlan)(e)}function s(e){return!!d(e)&&e.sku.split(";xtd;")[1].startsWith("LEAD::")}function l(e){var t=e.split(/::MAX::(\d)/);return parseInt(t[1],10)}function f(e){var t=e.split(";xtd;")[1];return null==t?void 0:t.split("::ERN:OFP:")[0]}t.normalizeCart=function(e,t){var n,r,a,u=!1;a=e,Boolean(a&&a.constructor===Object)?(u=Boolean(e.balance),t&&(n=t),e.cart&&(r=o.default.resolve(e.cart))):e&&(n=e);var d=function(e,t){e&&console.error(e),"function"==typeof n&&n(e,t)};void 0!==window.Extend?(r||(0,i.getCartData)()).then((function(e){window.Extend&&window.Extend.trackPlatformCartInfo&&window.Extend.trackPlatformCartInfo({platformCartId:e.id,platform:"BigCommerce"});var t=c(e,u);if(!t)return{updates:t,cart:e};var n=[];return Object.keys(t).forEach((function(r){0===t[r]?n.push((0,i.removeCartItem)({cartId:e.id,itemId:r})):n.push((0,i.updateCartQuantity)(r,t[r]))})),1===n.length?n[0].then((function(e){return{updates:t,cart:e}})):o.default.all(n).then((function(){return(0,i.getCartData)().then((function(e){return{updates:t,cart:e}}))}))})).then((function(e){return d(null,e)})).catch(d):d(new Error('Missing required dependency "Extend"'))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ExtendBigCommerce",{enumerable:!0,get:function(){return r.ExtendBigCommerce}}),Object.defineProperty(t,"ExtendBigCommerceInterface",{enumerable:!0,get:function(){return r.ExtendBigCommerceInterface}});var r=n(14)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ExtendBigCommerceInterface",{enumerable:!0,get:function(){return r.ExtendBigCommerceInterface}}),Object.defineProperty(t,"ExtendBigCommerce",{enumerable:!0,get:function(){return r.ExtendBigCommerce}});var r=n(15)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendBigCommerce=void 0;var r=n(16),o=n(8),i=n(12),a=n(22),c=n(23),u=n(11),d=n(24),s=n(25),l=n(26),f=n(27),p=n(4),m=n(28),v=n(29),h=n(30),g=n(31),y={handleAddToCart:r.handleAddToCart,addPlanToCart:o.addPlanToCart,normalizeCart:i.normalizeCart,getProductById:a.getProductById,getProductBySelectedOptions:c.getProductBySelectedOptions,warrantyAlreadyInCart:u.warrantyAlreadyInCart,deleteCartItem:d.deleteCartItem,addCartItem:s.addCartItem,getCart:l.getCart,removeSpPlanFromCart:f.removeSpPlanFromCart,formatCartItemsForSp:p.formatCartItemsForSp,isShippingProtectionInCart:m.isShippingProtectionInCart,addSpPlanToCart:v.addSpPlanToCart,updateSpPlanInCart:h.updateSpPlanInCart,updateExtendLineItems:g.updateExtendLineItems};t.ExtendBigCommerce=y},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleAddToCart=function(e,t){var n=t.modal,i=void 0===n||n,a=t.quantity,c=void 0===a?1:a,u=t.done,d=t.cart,s=t.priceBandRefId,l=(0,o.wrapCallback)(u);if(void 0===window.Extend)return void l(new Error('Missing required dependency "Extend"'));var f=window.Extend.buttons.instance(e);if(!f)return void l();var p=f.getPlanSelection(),m=f.getActiveProduct();if(p&&m)return void(0,r.addPlanToCart)({plan:p,sku:m.id,price:m.price,category:m.category,quantity:c,cart:d,priceBandRefId:s,offerType:{area:"product_page",component:"buttons"}},l);if(!i||!m)return void l();window.Extend.modal.open({referenceId:m.id,category:m.category,price:m.price,onClose:function(e,t){e&&t?(0,r.addPlanToCart)({plan:e,sku:t.id,price:t.price,category:t.category,quantity:c,cart:d,priceBandRefId:s,offerType:{area:"product_page",component:"modal"}},l):l()}})};var r=n(8),o=n(1)},function(e,t,n){"use strict";(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(o.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new i(o.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(18),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||void 0,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||void 0}).call(this,n(9))},function(e,t,n){"use strict";(function(e,t){!function(e,n){if(!e.setImmediate){var r,o,i,a,c,u=1,d={},s=!1,l=e.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(e);f=f&&f.setTimeout?f:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){m(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){m(e.data)},r=function(e){i.port2.postMessage(e)}):l&&"onreadystatechange"in l.createElement("script")?(o=l.documentElement,r=function(e){var t=l.createElement("script");t.onreadystatechange=function(){m(e),t.onreadystatechange=null,o.removeChild(t),t=null},o.appendChild(t)}):r=function(e){setTimeout(m,0,e)}:(a="setImmediate$"+Math.random()+"$",c=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&m(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",c,!1):e.attachEvent("onmessage",c),r=function(t){e.postMessage(a+t,"*")}),f.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var o={callback:e,args:t};return d[u]=o,r(u),u++},f.clearImmediate=p}function p(e){delete d[e]}function m(e){if(s)setTimeout(m,0,e);else{var t=d[e];if(t){s=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{p(e),s=!1}}}}}("undefined"==typeof self?void 0===e?void 0:e:self)}).call(this,n(9),n(19))},function(e,t,n){"use strict";var r,o,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function u(e){if(r===setTimeout)return setTimeout(e,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(e){r=a}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(e){o=c}}();var d,s=[],l=!1,f=-1;function p(){l&&d&&(l=!1,d.length?s=d.concat(s):f=-1,s.length&&m())}function m(){if(!l){var e=u(p);l=!0;for(var t=s.length;t;){for(d=s,s=[];++f<t;)d&&d[f].run();f=-1,t=s.length}d=null,l=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function v(e,t){this.fun=e,this.array=t}function h(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new v(e,t)),1!==s.length||l||u(m)},v.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=function(e){var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){return t.reject(n)}))}))};t.default=r},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(e){return new this((function(t,n){if(!e||void 0===e.length)return n(new TypeError(r(e)+" "+e+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var o=Array.prototype.slice.call(e);if(0===o.length)return t([]);var i=o.length;function a(e,n){if(n&&("object"===r(n)||"function"==typeof n)){var c=n.then;if("function"==typeof c)return void c.call(n,(function(t){a(e,t)}),(function(n){o[e]={status:"rejected",reason:n},0==--i&&t(o)}))}o[e]={status:"fulfilled",value:n},0==--i&&t(o)}for(var c=0;c<o.length;c++)a(c,o[c])}))};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getProductById=function(e){var t=e.productId,n=e.storefrontApiToken,o=e.done,i=function(e,t){e&&console.error(e),"function"==typeof o&&o(e,t)};if(void 0===window.Extend)return void i(new Error('Missing required dependency "Extend"'));var a=function(e){return"query SingleProduct {\n  site {\n    products (entityIds: [".concat(e,"]) {\n      edges {\n        node {\n          id\n          entityId\n          name\n          sku\n          variants {\n            edges {\n              node {\n                sku\n                entityId\n                productOptions {\n                  edges {\n                    node {\n                      entityId\n                      ... on MultipleChoiceOption {\n                        values {\n                          edges {\n                            node {\n                              entityId\n                            }\n                          }\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n}")}(t);(0,r.getGraphQLData)(a,n).then((function(e){return i(null,e)}))};var r=n(2)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getProductBySelectedOptions=function(e){var t=e.productId,n=e.productOptions,o=e.storefrontApiToken,i=e.done,a=function(e,t){e&&console.error(e),"function"==typeof i&&i(e,t)};if(void 0===window.Extend)return void a(new Error('Missing required dependency "Extend"'));var c=function(e,t){return"query ProductsWithOptionSelections {\n      site {\n        productWithSelectedOptions: product(\n          entityId: ".concat(e,"\n          optionValueIds: ").concat(t,"\n        ) {\n          ...ProductFields\n        }\n      }\n    }\n    fragment ProductFields on Product {\n      name\n      sku\n    }")}(t,JSON.stringify(n).replace(/"/g,""));(0,r.getGraphQLData)(c,o).then((function(e){return a(null,e)}))};var r=n(2)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deleteCartItem=function(e,t){var n=[];if(["cartId","itemId"].forEach((function(t){e&&e[t]||(console.warn('Missing required argument "'.concat(t,'" in deleteCartItem(opts, callback)')),n.push(t))})),n.length)return void(0,r.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-big-commerce/delete-cart-item - deleteCartItem",missingParams:n},sdkName:"extend-sdk-client-bigcommerce-addon"});var a=(0,i.wrapCallbackForCart)(t);(0,o.removeCartItem)(e).then((function(e){return a(null,e)})).catch(a)};var r=n(0),o=n(2),i=n(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addCartItem=function(e,t){var n=[];if(["cartId","productId","variantId","quantity"].forEach((function(t){e&&e[t]||(console.warn('Missing required argument "'.concat(t,'" in addCartItem(opts, callback)')),n.push(t))})),n.length)return void(0,r.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-big-commerce/add-cart-item - addCartItem",missingParams:n},sdkName:"extend-sdk-client-bigcommerce-addon"});var a=(0,i.wrapCallbackForCart)(t);(0,o.addItemToCart)(e).then((function(e){return a(null,e)})).catch(a)};var r=n(0),o=n(2),i=n(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCart=function(e){var t=(0,o.wrapCallbackForCart)(e);(0,r.getCartData)().then((function(e){return t(null,e)})).catch(t)};var r=n(2),o=n(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeSpPlanFromCart=function(e,t){var n=e.quote,d=e.cart,s=(0,i.wrapCallbackForCart)(t),l=[];n||l.push("quote");d||l.push("cart");if(l.length)return(0,r.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-big-commerce/remove-sp-plan-from-cart - removeSpPlanFromCart",missingParams:l},sdkName:"extend-sdk-client-bigcommerce-addon"}),void s(new Error('Missing required argument "'.concat(l,'" in removeSpPlanFromCart({quote, cart})')),d);var f=(0,c.getShippingPlan)(d.lineItems.customItems);if(!f)return void s(new Error("There is no shipping protection plan in cart"),d);(0,o.removeCartItem)({cartId:d.id,itemId:f.id}).then((function(e){var t=(0,u.formatCartItemsForSp)(e);return window.Extend.trackSPOfferRemovedFromCart({items:t,quote:n,message:a.SP_PLAN_REMOVED_FROM_CART_BY_USER}),s(null,e)})).catch(s)};var r=n(0),o=n(2),i=n(1),a=n(7),c=n(3),u=n(4)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isShippingProtectionInCart=function(e){if(!e)return console.warn('Missing required argument "cart" in isShippingProtectionInCart(cart)'),(0,r.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-big-commerce/shipping-protection-in-cart - isShippingProtectionInCart",missingParams:["cart"]},sdkName:"extend-sdk-client-bigcommerce-addon"}),!1;return e.lineItems.customItems.some((function(e){return(0,o.isSPPlan)(e)}))};var r=n(0),o=n(3)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addSpPlanToCart=function(e,t){var n=e.quote,u=e.cart,d=(0,r.wrapCallback)(t);if(void 0===window.Extend)return void d(new Error('Missing required dependency "Extend"'));if(!n||!Object.keys(n).length)return(0,i.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-big-commerce/add-sp-plan-to-cart - addSpPlanToCart",missingParams:["quote"]},sdkName:"extend-sdk-client-bigcommerce-addon"}),void d(new Error('Missing required argument "quote" in addSpPlanToCart({quote, cart})'));if(!u)return(0,i.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-big-commerce/add-sp-plan-to-cart - addSpPlanToCart",missingParams:["cart"]},sdkName:"extend-sdk-client-bigcommerce-addon"}),void d(new Error('Missing required argument "cart" in addSpPlanToCart({quote, cart})'));var s=window.Extend.config();if(!s.storeId)return(0,i.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-big-commerce/add-sp-plan-to-cart - addSpPlanToCart({quote, cart})",missingParams:["storeId"]},sdkName:"extend-sdk-client-bigcommerce-addon"}),void d(new Error('Could not find "storeId". Did you forget to call Extend.config()?'));Promise.resolve(u).then((function(e){var t=e.id;(0,a.addSpPlanToCart)({storeId:s.storeId,quote:n,cartId:t},s.environment).then((function(){d(null);var e=(0,c.formatCartItemsForSp)(u);window.Extend.trackSPOfferAddedToCart({items:e,quote:n,message:o.SP_PLAN_ADDED_TO_CART})})).catch((function(e){d(e)}))})).catch((function(e){d(e)}))};var r=n(1),o=n(7),i=n(0),a=n(5),c=n(4)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateSpPlanInCart=function(e,t){var n=e.quote,u=e.cart,d=(0,r.wrapCallback)(t);if(void 0===window.Extend)return void d(new Error('Missing required dependency "Extend"'));if(!n||!Object.keys(n).length)return(0,o.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-big-commerce/update-sp-plan-in-cart - updateSpPlanInCart",missingParams:["quote"]},sdkName:"extend-sdk-client-bigcommerce-addon"}),void d(new Error('Missing required argument "quote" in updateSpPlanInCart({quote, cart})'));if(!u)return(0,o.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-big-commerce/update-sp-plan-in-cart - updateSpPlanInCart",missingParams:["cart"]},sdkName:"extend-sdk-client-bigcommerce-addon"}),void d(new Error('Missing required argument "cart" in updateSpPlanInCart({quote, cart})'));var s=window.Extend.config();if(!s.storeId)return(0,o.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-big-commerce/update-sp-plan-in-cart - updateSpPlanInCart({quote, cart})",missingParams:["storeId"]},sdkName:"extend-sdk-client-bigcommerce-addon"}),void d(new Error('Could not find "storeId". Did you forget to call Extend.config()?'));var l=u.lineItems.customItems.find((function(e){return"Extend Shipping Protection Plan"===e.name}));if(!l)return void d(null,{spPlanUpdated:!1});if(!(0,i.isSpPlanChangeRequired)(l,n))return void d(null,{spPlanUpdated:!1});(0,a.updateSpPlanInCart)({storeId:s.storeId,quote:n,cartId:u.id,existingSpItemId:l.id},s.environment).then((function(){d(null,{spPlanUpdated:!0});var e=(0,c.formatCartItemsForSp)(u),t=(0,i.getSPPlanDetails)(l),r=t.quoteId,o=t.premium;window.Extend.trackSPOfferUpdatedInCart({items:e,quote:n,oldQuoteId:r,oldPremium:o})})).catch(d)};var r=n(1),o=n(0),i=n(3),a=n(5),c=n(4)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.updateExtendLineItems=function(e,t){var n=(0,r.wrapCallback)(t);if(void 0===window.Extend)return void n(new Error('Missing required dependency "Extend"'));var f=window.Extend.config();if(!f.storeId)return(0,a.dispatchErrorEvent)({type:"method_missing_param",error:{functionContext:"extend-big-commerce/update-extend-line-items - updateExtendLineItems({balanceCart, callback})",missingParams:["storeId"]},sdkName:"extend-sdk-client-bigcommerce-addon"}),void n(new Error('Could not find "storeId". Did you forget to call Extend.config()?'));(0,o.getCartData)().then((function(t){var r=(0,i.formatCartItemsForSp)(t);(0,c.getUpdatedSpQuote)(r).then((function(r){var i=r.quote,a=r.attachBehavior,p=(0,c.getSPCartUpdates)({quote:i,attachBehavior:a,cart:t}),m=(0,u.getCartUpdates)(t,e.balanceCart);if(!p.shouldAddSp&&!p.spUpdates&&!m)return n(null,{cart:t});var v=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},m),h={},g=function(e,t,n,r,i){var a=[],c=e.spUpdates;e.shouldAddSp&&r&&a.push((0,d.addSpPlanToCart)({quote:r,cartId:n.id,storeId:i.storeId},i.environment));c&&Object.keys(c).forEach((function(e){var t=c[e];"remove"===t&&a.push((0,o.removeCartItem)({cartId:n.id,itemId:e})),"update"===t&&a.push((0,o.updateCartQuantity)(e,1)),"replace"===t&&r&&a.push((0,d.updateSpPlanInCart)({quote:r,storeId:i.storeId,cartId:n.id,existingSpItemId:e},i.environment))}));t&&Object.keys(t).forEach((function(e){var r=t[e];0===r?a.push((0,o.removeCartItem)({cartId:n.id,itemId:e})):a.push((0,o.updateCartQuantity)(e,r))}));return a}(p,m,t,i,f),y=p.spUpdates;return y&&Object.keys(y).forEach((function(e){"replace"!==y[e]&&"remove"!==y[e]||(v[e]=0),"update"===y[e]&&(v[e]=1)})),Promise.all(g).then((function(){return(0,o.getCartData)().then((function(e){if(p.shouldAddSp||p.spUpdates&&Object.values(p.spUpdates).includes("replace")){var t=(0,c.getShippingPlan)(e.lineItems.customItems);t&&i&&(h[t.id]=i.id)}return n(null,{cart:e,updates:Object.entries(v).length?v:void 0,additions:Object.entries(h).length?h:void 0})}))}))}))})).catch(n)};var r=n(1),o=n(2),i=n(4),a=n(0),c=n(3),u=n(12),d=n(5);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}}]).ExtendBigCommerce}));