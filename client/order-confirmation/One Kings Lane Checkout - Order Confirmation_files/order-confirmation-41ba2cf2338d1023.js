(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8937,2803],{98083:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/order-confirmation",function(){return c(48878)}])},48878:function(a,b,c){"use strict";c.r(b),c.d(b,{default:function(){return S}});var d=c(47568),e=c(34051),f=c.n(e),g=c(85893),h=c(67294),i=c(89070),j=c(7762),k=c(16977),l=c(26042),m=c(69396),n=function(a){var b=a.setOpenModal,c=a.setOffer;(0,h.useEffect)(function(){var a=function(a){var d=a.offer;d&&Object.keys(d).length&&(c(d),b(!0))};return document.addEventListener("displayLoyaltyProgramSignup",a),function(){document.removeEventListener("displayLoyaltyProgramSignup",a)}},[b,c])},o=n,p=c(45468),q=c(51713),r=c.n(q),s="One Kings Lane",t="OKL Rewards",u="OKL Rewards",v=function(a){var b=a.loyaltyConversionRate,c=a.initialBonus,d=[{imageName:"0",title:"".concat(b,"% cash back in ").concat(t," on every purchase"),subtitle:"Start earning every time you shop."},{imageName:"1",title:"$".concat(c," bonus in ").concat(t,"*"),subtitle:"One-time gift just for joining."},{imageName:"2",title:"Exclusive free shipping events",subtitle:"Access to member-only sales and shipping events."},{imageName:"3",title:"Pre-launch access to flash sales",subtitle:"24 hours to pick up the best deals before they sell out."},];return(0,g.jsxs)("div",{className:r().infoGraphBackground,children:[d.map(function(a){var b=a.imageName,c=a.title,d=a.subtitle;return(0,g.jsxs)("div",{className:r().infoGraphEntry,children:[(0,g.jsx)("div",{className:r().imageWrapper,children:(0,g.jsx)("img",{src:"/__statics/images/z-rewards-".concat(b,".svg"),alt:b,className:r().infoGraphImage})}),(0,g.jsx)("h3",{"data-testid":"".concat(b,"-title-message"),className:r().title,children:c}),(0,g.jsx)("p",{className:r().subtitle,children:d})]},b)}),(0,g.jsx)("img",{alt:"z-rewards-sofa",src:"/__statics/images/z-rewards-sofa.png",className:r().sofa})]})},w=v,x=c(70799),y=function(a){var b=a.loyaltyProgramCost,c=a.offer;return(0,g.jsx)(p.default,{className:r().rewardsText,children:(0,g.jsxs)("b",{children:["Join"," ",u," ","for $",b," ","per"," ",c.billingFrequency," ","and start earning on all your purchases!"]})})},z=function(a){var b=a.loyaltyProgramCost,c=a.offer;return(0,g.jsx)("div",{className:r().bottomTextGroup,children:(0,g.jsxs)("p",{children:["By clicking the “Join"," ",t," ","Rewards” button below, you agree to our"," ",(0,g.jsxs)("span",{className:"ssr-underline",children:[(0,g.jsxs)("a",{href:"/customer-service/z-rewards-terms-and-conditions",target:"_blank",children:[t," ","Rewards Membership Program Terms & Conditions,"]})," ",(0,g.jsx)("a",{href:"/customer-service/privacy-policy",target:"_blank",children:"Privacy Policy"})," ","and"," ",(0,g.jsx)("a",{href:"/customer-service/terms-and-conditions",target:"_blank",children:"Terms & Conditions"})]}),", that you are over 18, and that you agree for"," ",s," ","to automatically charge the membership fee (currently $",b,"/",c.billingFrequency,") plus applicable taxes on a recurring basis to your saved method of payment. Your membership will be automatically renewed each year at the then-current rate, of which you will be notified prior to automatic renewal, until you choose to cancel. To cancel, go to Account and click “Cancel Membership.”",(0,g.jsxs)("b",{children:["The"," ",t," ","Rewards membership fee won’t be refunded when you cancel unless legally required."]}),"Your payment data is encrypted and secure."," ",t," ","is a digital asset that can fluctuate in value."," ",t," ","members will always be able to redeem the original cash value earned, or more as long as the Member’s"," ",t," ","Rewards membership is active."]})})},A=function(){return(0,g.jsxs)(p.default,{children:["By clicking the button, you agree to the"," ",(0,g.jsxs)("a",{href:"/customer-service/terms-and-conditions",target:"_blank",children:[s," ","Terms &"," ","Conditions"]})," ","and the"," ",(0,g.jsxs)("a",{href:"/customer-service/z-rewards-terms-and-conditions",target:"_blank",children:[t," ","Rewards Terms & Conditions"]})]})},B=function(a){var b=a.children,c=a.dynamicCashback,d=a.initialBonus,e=a.loyaltyConversionRate,f=a.loyaltyProgramCost,h=a.offer;return(0,g.jsxs)("div",{className:r().consentScreen,children:[(0,g.jsxs)("div",{className:r().topTextGroup,children:[(0,g.jsx)("h1",{children:"Thank you for your order."}),(0,g.jsxs)("div",{"data-testid":"bonus-amount-message",className:r().rewardsText,children:["You qualify for"," ",(0,g.jsxs)("b",{children:["$",(0,x.Z)(c).toFixed(2)]})," ","in"," ",t," ","for today's purchase."," "]}),(0,g.jsxs)("div",{className:r().rewardsText,children:[" ","Includes,"," ",(0,g.jsxs)("b",{children:["$",d]})," ","one-time bonus in"," ",u,"."]}),(0,g.jsx)("img",{className:r().consentScreenLogo,src:"/__statics/images/z-rewards-logo.svg",alt:u}),(0,g.jsx)(p.default,{className:r().saveText,children:"Save on every purchase and enjoy member-only benefits"})]}),(0,g.jsx)(w,{initialBonus:d,loyaltyConversionRate:e}),(0,g.jsx)(y,{loyaltyProgramCost:f,offer:h}),!h.order.cart.customerId&&h.canCreateCustomer&&(0,g.jsxs)(p.default,{className:r().signUpScreenGuestText,children:["To enroll, you will need to create an account and your credit card (ending with"," ",h.instrument.last4,") will be automatically charged and saved for recurring annual payments."]}),(0,g.jsx)(A,{}),b,(0,g.jsx)(z,{loyaltyProgramCost:f,offer:h})]})},C=B,D=function(a){var b=a.children,c=a.dynamicCashback,d=a.initialBonus,e=a.loyaltyProgramCost,f=a.loyaltyConversionRate;return(0,g.jsxs)("div",{className:r().confirmationScreen,children:[(0,g.jsxs)("div",{className:r().confirmationTextGroup,children:[(0,g.jsx)("p",{className:r().topWelcomeText,children:"Welcome to"}),(0,g.jsx)("img",{className:r().confirmationPageLogo,src:"/__statics/images/z-rewards-logo.svg",alt:"Z rewards"}),(0,g.jsx)("p",{style:{margin:"16px 0"},children:"You have earned your first reward!"}),(0,g.jsxs)("div",{children:[(0,g.jsxs)("b",{children:["$",(0,x.Z)(c).toFixed(2)]})," "," ","in"," ",t," ","is in your account!"]}),(0,g.jsxs)("div",{children:["Includes $",d," "," ","one-time bonus in"," ",t]}),(0,g.jsxs)("p",{className:r().annualMembership,children:["Your annual membership fee of $",e," ","is paid and your account is active"]}),(0,g.jsx)("p",{style:{margin:"16px 0 8px"},children:"Save on every purchase and enjoy member-only benefits"})]}),(0,g.jsx)(w,{initialBonus:d,loyaltyConversionRate:f}),b]})},E=D,F=c(27429),G=c(5152),H=c.n(G),I=c(72803),J=c(70653),K=c(20580),L=c(37890),M=H()(function(){return c.e(9589).then(c.bind(c,89589))},{loadableGenerated:{webpack:function(){return[89589]}}}),N=function(){var a,b,c=(0,h.useState)(!1),d=c[0],e=c[1],f=(0,h.useState)(!1),i=f[0],j=f[1],k=(0,h.useState)(null),n=k[0],p=k[1];o({setOpenModal:e,setOffer:p});var q=(0,h.useState)(!1),s=q[0],t=q[1],v=(0,h.useState)("consent"),w=v[0],x=v[1],y=d&&!!(null==n?void 0:n.dynamicCashback)&&(!!(null==n?void 0:null===(a=n.order)|| void 0===a?void 0:null===(b=a.cart)|| void 0===b?void 0:b.customerId)||(null==n?void 0:n.canCreateCustomer))&&window.shoptoken;return y?(0,g.jsxs)("div",{className:r().signUpScreenGlobals,children:[(0,g.jsx)(M,{loading:i}),(0,g.jsx)("button",{"data-testid":"loyalty-signup-modal-close-button",type:"button",className:r().closeButton,onClick:function(){e(!1)},"aria-label":"Close",children:" "}),"consent"===w&&(0,g.jsx)(C,{offer:n,dynamicCashback:(null==n?void 0:n.dynamicCashback)||0,initialBonus:(null==n?void 0:n.initialBonus)||0,loyaltyConversionRate:(null==n?void 0:n.loyaltyConversionRate)||0,loyaltyProgramCost:(null==n?void 0:n.loyaltyProgramCost)||"0",children:(0,g.jsxs)("div",{className:r().consentScreenButtonsArea,children:[(0,g.jsxs)("button",{"data-testid":"loyalty-signup-modal-subscribe",className:r().consentScreenSubmit,type:"button",disabled:s,onClick:function(){!s&&(j(!0),t(!0),(0,L.Ou)(n).then(function(){x("confirmation"),j(!1)}).catch(function(a){(0,F.vU)("Failed to enroll customer on loyalty program",a),(0,K.$e)(function(a){var b,c;a.setContext("subscribeCustomerInput",(0,m.Z)((0,l.Z)({},n),{instrument:null,credentials:null,email:(null===(b=n.order)|| void 0===b?void 0:null===(c=b.cart)|| void 0===c?void 0:c.customerId)?void 0:n.order.cart.email,payment:{paymentId:n.instrument.last4}}))}),(0,K.Tb)(a),(0,F.vU)("Error registering the user",a),t(!1),j(!1)}).finally(function(){(0,J.getCart)().then(function(a){return(null==a?void 0:a.id)?(0,I.deleteCart)(null==a?void 0:a.id):Promise.resolve()}).catch(function(a){(0,F.vU)("Error deleting the cart",a)})}))},children:["Claim your"," ",u]}),(0,g.jsx)("button",{"data-testid":"loyalty-signup-modal-im-not-interested",className:r().notInterested,type:"button",onClick:function(){e(!1)},children:"I'm not interested"})]})}),"confirmation"===w&&(0,g.jsx)(E,{initialBonus:null==n?void 0:n.initialBonus,loyaltyConversionRate:null==n?void 0:n.loyaltyConversionRate,loyaltyProgramCost:null==n?void 0:n.loyaltyProgramCost,dynamicCashback:null==n?void 0:n.dynamicCashback,children:(0,g.jsxs)("div",{className:r().confirmationPageButtonsArea,children:[(0,g.jsxs)("button",{type:"button","data-testid":"loyalty-signup-modal-view-reward",className:r().viewAccountButton,onClick:function(){try{var a;null===(a=window.shoptoken)|| void 0===a||a.showWidget(),e(!1)}catch(b){(0,F.vU)("Error opening the widget",b)}},children:["Click here to view your"," ",u," ","account"]}),(0,g.jsxs)("p",{children:["Make everyday glamorous with"," ",u,"!"]}),(0,g.jsx)("button",{"data-testid":"loyalty-signup-modal-start-shopping",type:"button",onClick:function(){try{var a;null===(a=window.shoptoken)|| void 0===a||a.showWidget(),e(!1)}catch(b){(0,F.vU)("Error opening the widget",b)}},className:r().confirmationPageSubmit,children:"Start shopping"})]})})]}):null},O=N;c(34155);var P,Q={margin:0,padding:0,position:"fixed",top:0,left:0,border:"none",width:"100%",height:"100%",overflow:"hidden",zIndex:2},R=function(a){var b=a.orderId,c=(0,h.useRef)();return(0,j.D)(c,i.Z,null,null),(0,g.jsxs)("div",{children:[(0,g.jsx)("iframe",{title:"order-confirmation-iframe",ref:c,src:"".concat(k.CHECKOUT_DOMAIN,"/").concat(k.CHECKOUT_IDENTIFIER,"/confirmation/").concat(b),style:Q,"data-hj-allow-iframe":!0}),(0,g.jsx)(O,{})]})};R.getInitialProps=(P=(0,d.Z)(f().mark(function a(b){var c,d,e,g;return f().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=b.query,d=b.asPath,e=b.query,g=(void 0===e?{}:e).orderId,a.abrupt("return",{orderId:g});case 3:case"end":return a.stop()}},a)})),function(a){return P.apply(this,arguments)});var S=R},72803:function(a,b,c){"use strict";c.r(b),c.d(b,{addSingleLineItemToCart:function(){return t},attemptToRecreateCart:function(){return v},createCartWithSingleLineItem:function(){return u},deleteCart:function(){return s},recreateOrder:function(){return w}});var d,e,f,g,h=c(47568),i=c(828),j=c(29815),k=c(34051),l=c.n(k),m=c(27429),n=c(6888),o=c(10182),p=c(48080),q=c(9669),r=c.n(q),s=(d=(0,h.Z)(l().mark(function a(b){return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r().delete("/api/storefront/carts/".concat(b));case 2:case"end":return a.stop()}},a)})),function(a){return d.apply(this,arguments)}),t=function(a){var b;return b=(0,h.Z)(l().mark(function b(c){var d,e;return l().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.prev=0,b.next=3,r().post("/api/storefront/carts/".concat(a,"/items?include=lineItems.physicalItems.options"),{lineItems:[{productId:c.productId,quantity:c.quantity,variantId:c.variantId},]});case 3:return e=(d=b.sent).data,(0,n.assertBCCarts)([e]),b.abrupt("return",e);case 9:return b.prev=9,b.t0=b.catch(0),b.abrupt("return",null);case 12:case"end":return b.stop()}},b,null,[[0,9]])})),function(a){return b.apply(this,arguments)}},u=(e=(0,h.Z)(l().mark(function a(b){var c,d;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,(0,m.cM)("Creating new cart with",{body:{lineItems:[{productId:b.productId,quantity:b.quantity,variantId:b.variantId}]}}),a.next=4,r().post("/api/storefront/carts?include=lineItems.physicalItems.options",{lineItems:[b]});case 4:return d=(c=a.sent).data,(0,n.assertBCCarts)([d]),a.abrupt("return",d.id);case 10:return a.prev=10,a.t0=a.catch(0),(0,m.vU)("Failed to create cart with line Item"),a.abrupt("return",null);case 14:case"end":return a.stop()}},a,null,[[0,10]])})),function(a){return e.apply(this,arguments)}),v=(f=(0,h.Z)(l().mark(function a(b){var c,d;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=null,a.prev=1,a.next=4,u(b[0]);case 4:c=a.sent,a.next=10;break;case 7:a.prev=7,a.t0=a.catch(1),(0,m.cM)("we failed to add the first item to the cart");case 10:if(d=b.slice(1),!(!c&&b.length>1)){a.next=16;break}return a.next=14,v(d);case 14:a.next=28;break;case 16:if(!c){a.next=27;break}return a.prev=17,a.next=20,Promise.all(d.map(t(c)));case 20:a.next=25;break;case 22:a.prev=22,a.t1=a.catch(17),(0,m.cM)("some of the items failed to be readded to the cart");case 25:a.next=28;break;case 27:(0,m.cM)("we failed to add any items to the cart");case 28:case"end":return a.stop()}},a,null,[[1,7],[17,22]])})),function(a){return f.apply(this,arguments)}),w=(g=(0,h.Z)(l().mark(function a(b){var d,e,f,g,h,k,q,t,u,v,w,x;return l().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=b.order,(0,m.cM)("recoverAvailableShippingOptions START",{order:d}),a.t0=i.Z,a.next=5,(0,p.Z)(function(){return[Promise.resolve().then(c.bind(c,93239)),Promise.resolve().then(c.bind(c,68203)),]});case 5:return a.t1=a.sent,f=(e=(0,a.t0)(a.t1,2))[0].standardizeOrderFromResponse,g=e[1].standardizeAddressForBigC,a.prev=9,k=d.shipments.map(function(a){var b=a.lineItems,c=a.shippingAddress;return{lineItems:b.map(function(a){var b=a.productId,c=a.variantId,d=a.quantity;return{productId:b,variantId:c,quantity:d}}),shippingAddress:c}}),q=d.cart.lineItems.map(function(a){var b=a.productId,c=a.quantity,d=a.variantId;return{productId:b,quantity:c,variantId:d}}),(0,m.cM)({originalProductsDistribution:k,originalLineItems:q}),(0,m.cM)(" Deleting cart",{cart:null==d?void 0:d.cart}),a.next=17,s(null==d?void 0:d.cart.id);case 17:return(0,m.cM)("Creating a new cart with previous items",{lineItems:q}),a.next=20,r().post("/api/storefront/carts",{lineItems:q});case 20:return t=a.sent.data,(0,n.assertBCCarts)(t),u=(0,j.Z)(t.lineItems.physicalItems),v=k.map(function(a){var b=a.shippingAddress,c=a.lineItems;return{shippingAddress:g(b),lineItems:c.map(function(a){var b,c=a.productId,d=a.variantId,e=a.quantity;return{itemId:String(null===(b=u.find(function(a){return a.productId===c&&a.variantId===d}))|| void 0===b?void 0:b.id),quantity:e}})}}),(0,m.cM)("Recreating consignments",{newCart:t,newLineItems:u,newConsignments:v}),a.next=27,r().post("/api/storefront/checkouts/".concat(null==t?void 0:t.id,"/consignments?include=consignments.availableShippingOptions"),v);case 27:if(a.t3=h=a.sent,a.t2=null===a.t3,a.t2){a.next=31;break}a.t2=void 0===h;case 31:if(!a.t2){a.next=35;break}a.t4=void 0,a.next=36;break;case 35:a.t4=h.data;case 36:return w=a.t4,(0,o.assertBCCheckout)(w),a.next=40,f({bigcResponse:w,order:d});case 40:return x=a.sent,(0,m.cM)("New standardized order",{newOrder:x}),a.abrupt("return",{newOrder:x,success:!0});case 45:a.prev=45,a.t5=a.catch(9),(0,m.vU)("recoverAvailableShippingOptions ERROR",a.t5);case 48:return a.abrupt("return",{success:!1,newOrder:null});case 49:case"end":return a.stop()}},a,null,[[9,45]])})),function(a){return g.apply(this,arguments)});b.default=w},51713:function(a){a.exports={signUpScreenGuestText:"LoyaltySignup_signUpScreenGuestText__9rMjA",signUpScreenGlobals:"LoyaltySignup_signUpScreenGlobals__QiRzs",closeButton:"LoyaltySignup_closeButton__HhuNl",notInterested:"LoyaltySignup_notInterested__aHcyh",consentScreenSubmit:"LoyaltySignup_consentScreenSubmit__QzJoL",confirmationPageSubmit:"LoyaltySignup_confirmationPageSubmit__D3poO",topTextGroup:"LoyaltySignup_topTextGroup__1znhv",bottomTextGroup:"LoyaltySignup_bottomTextGroup__vxskv",consentScreen:"LoyaltySignup_consentScreen__4RQbK",consentScreenLogo:"LoyaltySignup_consentScreenLogo__ZmP7X",consentScreenButtonsArea:"LoyaltySignup_consentScreenButtonsArea___tVn_",confirmationScreen:"LoyaltySignup_confirmationScreen__nQ9mw",confirmationTextGroup:"LoyaltySignup_confirmationTextGroup__cJ2Rp",confirmationPageLogo:"LoyaltySignup_confirmationPageLogo__TpAO6",confirmationPageButtonsArea:"LoyaltySignup_confirmationPageButtonsArea__omsmw",topWelcomeText:"LoyaltySignup_topWelcomeText__egMpB",viewAccountButton:"LoyaltySignup_viewAccountButton__0oP3A",infoGraphBackground:"LoyaltySignup_infoGraphBackground__wBdFg",infoGraphEntry:"LoyaltySignup_infoGraphEntry__l490j",infoGraphImage:"LoyaltySignup_infoGraphImage__aSwGp",sofa:"LoyaltySignup_sofa__Egp1W",subtitle:"LoyaltySignup_subtitle__UZxF8",annualMembership:"LoyaltySignup_annualMembership__lU2Pz",rewardsText:"LoyaltySignup_rewardsText__Bigko",saveText:"LoyaltySignup_saveText__aD_5a"}}},function(a){a.O(0,[2506,3714,9669,3996,9638,8924,3106,1485,2054,6778,8373,639,3830,6317,8034,7603,9774,2888,179],function(){var b;return a(a.s=98083)}),_N_E=a.O()}])
//# sourceMappingURL=order-confirmation-41ba2cf2338d1023.js.map